<!DOCTYPE html>
<html lang="zh_CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.2',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Kopieren',
      copy_success: 'Kopiert',
      copy_failure: 'Kopieren fehlgeschlagen'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="0x01 名称由来Sail，可以意为启航，表示即将开启一段新的征程。云雀0x02 基本的配置过程jaspar-client（1）选择Expand Filesystem，并重启1sudo raspi-config（2）安装必要的工具123456sudo apt-get updatesudo apt-get upgrade --yessudo apt-get install nano git-core">
<meta name="keywords" content="Raspberry,sailbox">
<meta property="og:type" content="article">
<meta property="og:title" content="SAIL BOX">
<meta property="og:url" content="http://yoursite.com/posts/project/ideaTalk/1_sailbox_rpi.html">
<meta property="og:site_name" content="AOYI">
<meta property="og:description" content="0x01 名称由来Sail，可以意为启航，表示即将开启一段新的征程。云雀0x02 基本的配置过程jaspar-client（1）选择Expand Filesystem，并重启1sudo raspi-config（2）安装必要的工具123456sudo apt-get updatesudo apt-get upgrade --yessudo apt-get install nano git-core">
<meta property="og:locale" content="zh_CN">
<meta property="og:updated_time" content="2021-10-31T13:34:37.546Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SAIL BOX">
<meta name="twitter:description" content="0x01 名称由来Sail，可以意为启航，表示即将开启一段新的征程。云雀0x02 基本的配置过程jaspar-client（1）选择Expand Filesystem，并重启1sudo raspi-config（2）安装必要的工具123456sudo apt-get updatesudo apt-get upgrade --yessudo apt-get install nano git-core">

<link rel="canonical" href="http://yoursite.com/posts/project/ideaTalk/1_sailbox_rpi.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>SAIL BOX | AOYI</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AOYI</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Navigationsleiste an/ausschalten">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Startseite</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archiv</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh_CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/posts/project/ideaTalk/1_sailbox_rpi.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Pursuer">
      <meta itemprop="description" content="追根溯源，返璞归真">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AOYI">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SAIL BOX
        </h1>

        <div class="post-meta">

            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-10-24 22:11:30" itemprop="dateCreated datePublished" datetime="2021-10-24T22:11:30+08:00">2021-10-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/project/" itemprop="url" rel="index">
                    <span itemprop="name">学习琐事</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="0x01-名称由来"><a href="#0x01-名称由来" class="headerlink" title="0x01 名称由来"></a>0x01 名称由来</h2><p>Sail，可以意为启航，表示即将开启一段新的征程。</p><p>云雀</p><h2 id="0x02-基本的配置过程"><a href="#0x02-基本的配置过程" class="headerlink" title="0x02 基本的配置过程"></a>0x02 基本的配置过程</h2><p><a href="https://github.com/jasperproject/jasper-client" target="_blank" rel="noopener">jaspar-client</a></p><p>（1）选择Expand Filesystem，并重启</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo raspi-config</span><br></pre></td></tr></table></figure><p>（2）安装必要的工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade --yes</span><br><span class="line">sudo apt-get install nano git-core python-dev bison libasound2-dev libportaudio-dev python-pyaudio --yes</span><br><span class="line">sudo apt-get remove python-pip</span><br><span class="line"><span class="comment"># error for installing pip（需要源码先安装setup-tools，再源码编译安装pip）</span></span><br><span class="line"><span class="comment"># sudo easy_install pip</span></span><br></pre></td></tr></table></figure><a id="more"></a>








<p>（3）插上USB麦克风，创建一个ALSA的配置文件，内容如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /lib/modprobe.d/sailbox.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Load USB audio before the internal soundcard</span></span><br><span class="line">options snd_usb_audio index=0</span><br><span class="line">options snd_bcm2835 index=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make sure the sound cards are ordered the correct way in ALSA</span></span><br><span class="line">options snd slots=snd_usb_audio,snd_bcm2835</span><br></pre></td></tr></table></figure>

<p>（4）重启RPi</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo shutdown -r now</span><br></pre></td></tr></table></figure>

<p>（5）记录一些声音文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arecord temp.wav</span><br></pre></td></tr></table></figure>

<p>（6）回放声音文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aplay -D hw:1,0 temp.wav</span><br></pre></td></tr></table></figure>

<p>（7）修改’.bash_profile’，添加如下内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="string">"/usr/local/lib"</span></span><br><span class="line"><span class="built_in">source</span> .bashrc</span><br></pre></td></tr></table></figure>

<p>（8）修改’.bashrc’，添加如下内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LD_LIBRARY_PATH=<span class="string">"/usr/local/lib"</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH</span><br><span class="line">PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/lib/</span><br><span class="line"><span class="built_in">export</span> PATH</span><br></pre></td></tr></table></figure>

<h2 id="0x03-安装Jasper"><a href="#0x03-安装Jasper" class="headerlink" title="0x03 安装Jasper"></a>0x03 安装Jasper</h2><p>（1）下载jasper源码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/jasperproject/jasper-client.git jasper</span><br></pre></td></tr></table></figure>

<p>（2）安装必须的Python库文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install --upgrade setuptools</span><br><span class="line">sudo pip install -r jasper/client/requirements.txt</span><br></pre></td></tr></table></figure>

<p>替换requirements.txt中的版本号：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Jasper core dependencies</span></span><br><span class="line">APScheduler==3.8.1</span><br><span class="line">argparse==1.4.0</span><br><span class="line">mock==4.0.3</span><br><span class="line">pytz==2021.3</span><br><span class="line">PyYAML==6.0</span><br><span class="line">requests==2.26.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pocketsphinx STT engine</span></span><br><span class="line">cmuclmtk==0.1.5</span><br><span class="line"></span><br><span class="line"><span class="comment"># HN module</span></span><br><span class="line">beautifulsoup4==4.10.0</span><br><span class="line">semantic==1.0.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># Birthday/Notifications modules</span></span><br><span class="line">facebook-sdk==3.1.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Weather/News modules</span></span><br><span class="line">feedparser==6.0.8</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail module</span></span><br><span class="line">python-dateutil==2.8.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># MPDControl module</span></span><br><span class="line">python-mpd==0.3.0</span><br></pre></td></tr></table></figure>

<p>安装依赖报错时，执行下面的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3.7-dev</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-numpy python-scipy python-matplotlib  python-pandas python-sympy python-nose</span><br></pre></td></tr></table></figure>

<p>再次执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install -r jasper/client/requirements.txt</span><br></pre></td></tr></table></figure>

<p>（3）给jasper.py添加可执行权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x jasper/jasper.py</span><br></pre></td></tr></table></figure>

<h2 id="0x04-安装STT（语音识别）引擎和TTS（文本转文本）引擎"><a href="#0x04-安装STT（语音识别）引擎和TTS（文本转文本）引擎" class="headerlink" title="0x04 安装STT（语音识别）引擎和TTS（文本转文本）引擎"></a>0x04 安装STT（语音识别）引擎和TTS（文本转文本）引擎</h2><p>由于被动唤醒会试图识别所有听到的内容，出于隐私保护的目的，使用离线的语音识别引擎，因此选PocketSphinx或者Julius。</p>
<h3 id="安装-STT-引擎（Choosing-an-STT-engine）"><a href="#安装-STT-引擎（Choosing-an-STT-engine）" class="headerlink" title="安装 STT 引擎（Choosing an STT engine）"></a>安装 STT 引擎（Choosing an STT engine）</h3><h4 id="PocketSphinx-STT-engine"><a href="#PocketSphinx-STT-engine" class="headerlink" title="PocketSphinx STT engine"></a>PocketSphinx STT engine</h4><p>（1）sphinxbase &amp; pocketsphinx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install pocketsphinx python-pocketsphinx</span><br></pre></td></tr></table></figure>

<p>and:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.sourceforge.net/project/cmusphinx/sphinxbase/0.8/sphinxbase-0.8.tar.gz</span><br><span class="line">tar -zxvf sphinxbase-0.8.tar.gz</span><br><span class="line"><span class="built_in">cd</span> ~/sphinxbase-0.8/</span><br><span class="line">./configure --<span class="built_in">enable</span>-fixed</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.sourceforge.net/project/cmusphinx/pocketsphinx/0.8/pocketsphinx-0.8.tar.gz</span><br><span class="line">tar -zxvf pocketsphinx-0.8.tar.gz</span><br><span class="line"><span class="built_in">cd</span> ~/pocketsphinx-0.8/</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line"></span><br><span class="line"><span class="comment"># sudo easy_install pocketsphinx</span></span><br></pre></td></tr></table></figure>

<p>（2）CMUCLMTK<br>安装依赖文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install subversion autoconf libtool automake gfortran g++ --yes</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">svn co https://svn.code.sf.net/p/cmusphinx/code/trunk/cmuclmtk/</span><br><span class="line"><span class="built_in">cd</span> cmuclmtk/</span><br><span class="line">./autogen.sh &amp;&amp; make &amp;&amp; sudo make install</span><br><span class="line"><span class="built_in">cd</span> ..</span><br></pre></td></tr></table></figure>

<p>（3）MIT Language Modeling Toolkit<br>（4）m2m-aligner<br>（5）OpenFST &amp; Phonetisaurus</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http://distfiles.macports.org/openfst/openfst-1.5.2.tar.gz</span><br><span class="line">wget https://github.com/mitlm/mitlm/releases/download/v0.4.2/mitlm-0.4.2.tar.xz</span><br><span class="line">wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/m2m-aligner/m2m-aligner-1.2.tar.gz</span><br><span class="line">wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/phonetisaurus/is2013-conversion.tgz</span><br><span class="line"></span><br><span class="line">tar -xzvf m2m-aligner-1.2.tar.gz</span><br><span class="line">tar -xzvf openfst-1.5.2.tar.gz</span><br><span class="line">tar -xzvf is2013-conversion.tgz</span><br><span class="line">tar -xvJf mitlm_0.4.2.tar.xz</span><br></pre></td></tr></table></figure>

<p>Build OpenFST:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> openfst-1.5.2/</span><br><span class="line">sudo ./configure --<span class="built_in">enable</span>-compact-fsts --<span class="built_in">enable</span>-const-fsts --<span class="built_in">enable</span>-far --<span class="built_in">enable</span>-lookahead-fsts --<span class="built_in">enable</span>-pdt</span><br><span class="line"><span class="comment"># 修改1198行为fst_.InitArcIterator(state_, &amp;cache_data_);</span></span><br><span class="line">nano src/include/fst/replace.h</span><br><span class="line">sudo make install <span class="comment"># come back after a really long time, half an hour</span></span><br></pre></td></tr></table></figure>

<p>Build M2M:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> m2m-aligner-1.2/</span><br><span class="line">sudo make</span><br></pre></td></tr></table></figure>

<p>Build MITLMT:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> mitlm-0.4.2/</span><br><span class="line">sudo ./configure</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<p>Build Phonetisaurus:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> is2013-conversion/phonetisaurus/src</span><br><span class="line">sudo make</span><br></pre></td></tr></table></figure>

<p>Move some of the compiled files:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp ~/m2m-aligner-1.2/m2m-aligner /usr/<span class="built_in">local</span>/bin/m2m-aligner</span><br><span class="line">sudo cp ~/is2013-conversion/bin/phonetisaurus-g2p /usr/<span class="built_in">local</span>/bin/phonetisaurus-g2p</span><br></pre></td></tr></table></figure>

<p>Building the Phonetisaurus FST model</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#wget https://www.dropbox.com/s/kfht75czdwucni1/g014b2b.tgz</span></span><br><span class="line">https://pan.baidu.com/s/1o7MrWIA <span class="comment">#百度网盘下载g014b2b.tgz</span></span><br><span class="line">tar -xzvf g014b2b.tgz</span><br></pre></td></tr></table></figure>

<p>Build Phonetisaurus model:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> g014b2b/</span><br><span class="line">./compile-fst.sh</span><br><span class="line"><span class="built_in">cd</span> ..</span><br></pre></td></tr></table></figure>

<p>Rename the following folder for convenience:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv ~/g014b2b ~/phonetisaurus</span><br></pre></td></tr></table></figure>

<p>Finally, restart your Pi.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo shutdown -r now  <span class="comment">##重启</span></span><br><span class="line">sudo shutdown -h now  <span class="comment">##关机</span></span><br></pre></td></tr></table></figure>

<h4 id="Julius-STT-engine"><a href="#Julius-STT-engine" class="headerlink" title="Julius STT engine"></a>Julius STT engine</h4><p>（6）Install Dependencies for Julius STT engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install build-essential zlib1g-dev flex libasound2-dev libesd0-dev libsndfile1-dev</span><br><span class="line"></span><br><span class="line">wget https://osdn.net/projects/julius/downloads/60273/julius-4.3.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> ~/julius</span><br><span class="line">./configure --<span class="built_in">enable</span>-words-int</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<h3 id="安装-TTS-引擎（Choosing-a-TTS-engine）"><a href="#安装-TTS-引擎（Choosing-a-TTS-engine）" class="headerlink" title="安装 TTS 引擎（Choosing a TTS engine）"></a>安装 TTS 引擎（Choosing a TTS engine）</h3><p>（7）Install Dependencies for eSpeak TTS engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install espeak</span><br></pre></td></tr></table></figure>

<p>（8）Install Dependencies for Festival TTS engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install festival festvox-don</span><br></pre></td></tr></table></figure>

<p>（9）Install Dependencies for Flite TTS engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install flite</span><br></pre></td></tr></table></figure>

<p>（10）Install Dependencies for SVOX Pico TTS engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install libttspico-utils</span><br></pre></td></tr></table></figure>

<p>（11）Install Dependencies for Google TTS engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install python-pymad</span><br><span class="line">sudo pip install --upgrade gTTS</span><br></pre></td></tr></table></figure>

<p>（12）Install Dependencies for Ivona TTS engine</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install python-pymad</span><br><span class="line">sudo pip install --upgrade pyvona</span><br></pre></td></tr></table></figure>

<h2 id="0x05-安装百度语音引擎"><a href="#0x05-安装百度语音引擎" class="headerlink" title="0x05 安装百度语音引擎"></a>0x05 安装百度语音引擎</h2><h2 id="0x06-配置文件（-jasper-profile-yml）"><a href="#0x06-配置文件（-jasper-profile-yml）" class="headerlink" title="0x06 配置文件（.jasper/profile.yml）"></a>0x06 配置文件（.jasper/profile.yml）</h2><h3 id="生成配置文件"><a href="#生成配置文件" class="headerlink" title="生成配置文件"></a>生成配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/jasper/client</span><br><span class="line">python populate.py</span><br></pre></td></tr></table></figure>

<p>出现报错：<br>ImportError: No module named yaml<br>ImportError: No module named feedparser</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-yaml</span><br><span class="line">sudo apt-get install python-feedparser</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nano .jasper/profile.yml</span><br><span class="line"></span><br><span class="line">stt_engine: sphinx</span><br><span class="line">pocketsphinx:</span><br><span class="line">  fst_model: <span class="string">'../phonetisaurus/g014b2b.fst'</span></span><br><span class="line">  hmm_dir: <span class="string">'/usr/local/share/pocketsphinx/model/hmm/en_US/hub4wsj_sc_8k'</span></span><br><span class="line">tts_engine: espeak-tts</span><br><span class="line">espeak-tts:</span><br><span class="line">  voice: <span class="string">'default+m3'</span>   <span class="comment"># optional</span></span><br><span class="line">  pitch_adjustment: 40  <span class="comment"># optional</span></span><br><span class="line">  words_per_minute: 160 <span class="comment"># optional</span></span><br></pre></td></tr></table></figure>

<h3 id="配置Spotify"><a href="#配置Spotify" class="headerlink" title="配置Spotify"></a>配置Spotify</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wget -q -O - http://apt.mopidy.com/mopidy.gpg | sudo apt-key add -</span><br><span class="line">sudo wget -q -O /etc/apt/sources.list.d/mopidy.list http://apt.mopidy.com/mopidy.list</span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install python3-pykka</span><br><span class="line">sudo apt-get install python3-spotify</span><br><span class="line">sudo apt-get install mopidy mopidy-spotify --yes</span><br><span class="line"></span><br><span class="line">sudo modprobe ipv6</span><br><span class="line"><span class="built_in">echo</span> ipv6 | sudo tee -a /etc/modules</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /root/.asoundrc</span><br><span class="line"></span><br><span class="line">pcm.!default &#123;</span><br><span class="line">        <span class="built_in">type</span> hw</span><br><span class="line">        card 1</span><br><span class="line">&#125;</span><br><span class="line">ctl.!default &#123;</span><br><span class="line">        <span class="built_in">type</span> hw</span><br><span class="line">        card 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /root/.config</span><br><span class="line">sudo mkdir /root/.config/mopidy</span><br><span class="line">sudo rm /etc/init.d/mopidy</span><br><span class="line"></span><br><span class="line">sudo nano /root/.config/mopidy/mopidy.conf</span><br><span class="line"></span><br><span class="line">[spotify]</span><br><span class="line">username = YOUR_SPOTIFY_USERNAME</span><br><span class="line">password = YOUR_SPOTIFY_PASSWORD</span><br><span class="line"></span><br><span class="line">[mpd]</span><br><span class="line">hostname = ::</span><br><span class="line"></span><br><span class="line">[<span class="built_in">local</span>]</span><br><span class="line">media_dir = ~/music</span><br><span class="line"></span><br><span class="line">[scrobbler]</span><br><span class="line">enabled = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">[audio]</span><br><span class="line">output = alsasink</span><br></pre></td></tr></table></figure>

<p>设置开机自启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo crontab -e</span><br><span class="line">@reboot mopidy;</span><br></pre></td></tr></table></figure>

<h2 id="0x07-如何使用"><a href="#0x07-如何使用" class="headerlink" title="0x07 如何使用"></a>0x07 如何使用</h2><p>开启jasper</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/pi/project/intelligent_voice/jasper/jasper.py</span><br></pre></td></tr></table></figure>

<p>ImportError: No module named requests<br>ImportError: No module named pip.req<br>ImportError: No module named apscheduler.schedulers.background</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-requests</span><br><span class="line"><span class="comment">#curl https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.py</span></span><br><span class="line"><span class="comment">#sudo python2 get-pip.py</span></span><br><span class="line"><span class="comment">#python2 -m pip install requests</span></span><br><span class="line">python2.7 -m pip install req</span><br><span class="line">sudo pip2 install apscheduler</span><br></pre></td></tr></table></figure>

<p>NameError: global name ‘cmuclmtk’ is not defined</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注释vocabcompiler.py的290行</span></span><br></pre></td></tr></table></figure>

<p>设置开机自启</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo crontab -e</span><br><span class="line">@reboot /home/pi/project/intelligent_voice/jasper/jasper.py;</span><br></pre></td></tr></table></figure>

<p>修改唤醒的名称</p>
<p>使用命令行唤醒<br>Set the JASPER_HOME environment variable, then run main.py as follows: JASPER_HOME=”/home/pi” &amp;&amp; export JASPER_HOME &amp;&amp; python main.py –local. The –local flag enables the command-line interface (CLI)</p>
<p>小模块<br>（1）status</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install psutil</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/edouardpoitras/jasper-status.git status</span><br><span class="line">cp ~/project/intelligent_voice/modules_jasper/status/Status.py ~/project/intelligent_voice/jasper/client/modules/</span><br><span class="line">sudo shutdown -r now</span><br></pre></td></tr></table></figure>

<p>（2）Reboot</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/ArtBIT/jasper-module-reboot.git reboot</span><br><span class="line">cp reboot/Reboot.py /usr/<span class="built_in">local</span>/lib/jasper/client/modules/</span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>

<p>（3）shutdown</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/ArtBIT/jasper-module-shutdown.git shutdown</span><br><span class="line">cp shutdown/Shutdown.py /usr/<span class="built_in">local</span>/lib/jasper/client/modules/</span><br><span class="line">sudo shutdown</span><br></pre></td></tr></table></figure>

<h2 id="0x08-其他"><a href="#0x08-其他" class="headerlink" title="0x08 其他"></a>0x08 其他</h2><p>普通 USB 摄像头，需要安装一个 fswebcam 拍摄软件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install fswebcam</span><br></pre></td></tr></table></figure>

<p>查看树莓派的温度：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcgencmd measure_temp</span><br></pre></td></tr></table></figure>

<p>Macbook pro的上传和下载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># upload</span></span><br><span class="line">scp -r local_folder remote_username@remote_ip:remote_folder</span><br><span class="line"><span class="comment"># scp -r ./setuptools-58.3.0.tar.gz sulay@192.168.0.108:/Users/sulay/Downloads</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># download</span></span><br><span class="line">scp -r remote_username@remote_ip:remote_folder local_folder</span><br><span class="line"><span class="comment"># scp -r sulay@192.168.0.108:/Users/sulay/Downloads/g014b2b.zip ./</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># </span></span><br><span class="line">1.-v 显示进度</span><br><span class="line">2.-r 递归处理</span><br><span class="line">3.-C 压缩选项</span><br><span class="line">4.-P 选择端口</span><br></pre></td></tr></table></figure>

<p>FAQ:</p>
<p>（1）Why can’t I login to my Raspberry Pi after running Jasper?<br>Jasper’s attempts to connect with a wifi network may be interfering with your attempts to make an ethernet connection. To resolve this, disconnect your wifi adapter, restart your Jasper, then plug in the ethernet cable only after Jasper fails to find a wireless network.</p>
<p>（2）Can I control the volume or make Jasper more sensitive to sound levels?<br>Run alsamixer on your Raspberry Pi for microphone and speaker level controls. Raising the microphone level will help Jasper to hear your voice from a greater distance.</p>
<p>（3）Why do I get a segmentation fault when running main.py?<br>This is usually caused by the speech dictionary not being created during the boot process. Make sure you’ve added the boot script to crontab, then restart your Pi. If a dictionary.dic file is still not present in your client/ directory, just run jasper/boot/boot.py manually to force the dictionary generation.</p>
<p>（4）Can I change Jasper’s name?<br>Sure, you can just replace the “Jasper” name in main.py and musicmode.py. Then, create a new dictionary_persona.dic and languagemodel_persona.lm to include the new name you decide. We recommend the online lmtool to regenerate the dictionary and language model. More information is available here.</p>
<h2 id="0x09-profile的书写"><a href="#0x09-profile的书写" class="headerlink" title="0x09 profile的书写"></a>0x09 profile的书写</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">robot_name: <span class="string">'DINGDANG'</span>  <span class="comment"># 必须使用大写</span></span><br><span class="line">robot_name_cn: <span class="string">'叮当'</span></span><br><span class="line">first_name: <span class="string">'伟洲'</span></span><br><span class="line">last_name: <span class="string">'潘'</span></span><br><span class="line">timezone: HKT</span><br><span class="line">location: <span class="string">'深圳'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否接入微信</span></span><br><span class="line">wechat: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当微信发送语音时，是直接播放语音还是执行语音命令？</span></span><br><span class="line"><span class="comment"># true：直接播放</span></span><br><span class="line"><span class="comment"># false：执行语音命令（只支持百度STT，其他两种STT识别不准）</span></span><br><span class="line">wechat_echo: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 除了自己之外，还能响应 echo 指令的好友微信名单</span></span><br><span class="line"><span class="comment"># 如果填写 ['ALL'] 表示响应所有微信好友</span></span><br><span class="line"><span class="comment"># 如果填写 [] 表示不响应任何好友</span></span><br><span class="line">wechat_echo_text_friends: [<span class="string">'小Q'</span>, <span class="string">'HaHack'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 除了自己之外，还能直接播放语音的好友微信名单</span></span><br><span class="line"><span class="comment"># 如果填写 ['ALL'] 表示播放所有微信好友的语音</span></span><br><span class="line"><span class="comment"># 如果填写 [] 表示不播放任何好友的语音</span></span><br><span class="line">wechat_echo_voice_friends: [<span class="string">'小Q'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当有邮件时，是否朗读邮件标题</span></span><br><span class="line">read_email_title: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当内容过长（&gt; 200个字）时，是否继续朗读</span></span><br><span class="line"><span class="comment"># true：读</span></span><br><span class="line"><span class="comment"># false：改为发送内容</span></span><br><span class="line">read_long_content: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 最长朗读内容（仅当 read_long_content 为 false 时有效）</span></span><br><span class="line">max_length: 200</span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否使用邮箱发送长内容而不是微信</span></span><br><span class="line">prefers_email: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 勿扰模式，该时间段内不执行通知检查</span></span><br><span class="line">do_not_bother:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">true</span> <span class="comment"># 开启勿扰模式</span></span><br><span class="line">    since: 23    <span class="comment"># 开始时间</span></span><br><span class="line">    till: 9      <span class="comment"># 结束时间，如果比 since 小表示第二天</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># wav声音播放配置</span></span><br><span class="line"><span class="comment"># 可选值：</span></span><br><span class="line"><span class="comment"># aplay         - 子进程aplay播放</span></span><br><span class="line"><span class="comment"># pyaudio       - pyaudio模块播放</span></span><br><span class="line">sound_engine: aplay</span><br><span class="line"></span><br><span class="line"><span class="comment"># mp3文件播放配置</span></span><br><span class="line"><span class="comment"># 可选值：</span></span><br><span class="line"><span class="comment"># play          - 子进程play播放</span></span><br><span class="line"><span class="comment"># pygame        - pygame库播放(树莓派python默认自带，推荐配置)</span></span><br><span class="line"><span class="comment"># vlc           - vlc库播放(短音频可能播放有问题)</span></span><br><span class="line">music_engine: play</span><br><span class="line"></span><br><span class="line"><span class="comment"># 语音合成服务配置</span></span><br><span class="line"><span class="comment"># 可选值：</span></span><br><span class="line"><span class="comment"># baidu-tts     - 百度语音识别</span></span><br><span class="line"><span class="comment"># iflytek-tts   - 讯飞语音合成</span></span><br><span class="line"><span class="comment"># ali-tts       - 阿里语音合成</span></span><br><span class="line"><span class="comment"># google-tts    - 谷歌语音合成</span></span><br><span class="line">tts_engine: baidu-tts</span><br><span class="line"></span><br><span class="line"><span class="comment"># STT 服务配置</span></span><br><span class="line"><span class="comment"># 可选值：</span></span><br><span class="line"><span class="comment"># sphinx        - pocketsphinx离线识别引擎（需训练，参考修改唤醒词教程）</span></span><br><span class="line"><span class="comment"># baidu-stt     - 百度在线语音识别</span></span><br><span class="line"><span class="comment"># iflytek-stt   - 讯飞语音识别</span></span><br><span class="line"><span class="comment"># ali-stt       - 阿里语音识别</span></span><br><span class="line"><span class="comment"># google-stt    - 谷歌语音合成</span></span><br><span class="line">stt_engine: baidu-stt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 离线唤醒 SST 引擎</span></span><br><span class="line"><span class="comment"># 可选值：</span></span><br><span class="line"><span class="comment"># sphinx        - pocketspinx离线唤醒                                                                                                                                           </span></span><br><span class="line"><span class="comment"># snowboy-stt   - snowboy离线唤醒</span></span><br><span class="line">stt_passive_engine: sphinx</span><br><span class="line"></span><br><span class="line"><span class="comment"># pocketsphinx 唤醒SST引擎（默认）</span></span><br><span class="line">pocketsphinx:</span><br><span class="line">    fst_model: <span class="string">'/home/pi/g014b2b/g014b2b.fst'</span></span><br><span class="line">    hmm_dir: <span class="string">'/usr/share/pocketsphinx/model/hmm/en_US/hub4wsj_sc_8k'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># snowboy 唤醒SST引擎（可选）</span></span><br><span class="line"><span class="comment"># https://snowboy.kitt.ai/dashboard</span></span><br><span class="line">snowboy:</span><br><span class="line">    model: <span class="string">'/home/pi/dingdang/client/snowboy/dingdangdingdang.pmdl'</span>  <span class="comment"># 唤醒词模型</span></span><br><span class="line">    sensitivity: <span class="string">"0.5"</span>  <span class="comment"># 敏感度</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 百度语音服务</span></span><br><span class="line"><span class="comment"># http://yuyin.baidu.com/</span></span><br><span class="line">baidu_yuyin:</span><br><span class="line">    api_key: <span class="string">'填写你的百度应用的API Key'</span></span><br><span class="line">    secret_key: <span class="string">'填写你的百度应用的Secret Key'</span></span><br><span class="line">    per: 0  <span class="comment"># 发音人选择 0：女生；1：男生；3：度逍遥；4：度丫丫</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 讯飞语音服务</span></span><br><span class="line"><span class="comment"># api_id 及 api_key 需前往</span></span><br><span class="line"><span class="comment"># http://aiui.xfyun.cn/webApi</span></span><br><span class="line"><span class="comment"># 注册获取（注意创建的是WebAPI应用），仅使用语音合成无需注册</span></span><br><span class="line"><span class="comment"># 然后将主板的ip地址添加进ip白名单（建议使用中转服务器的ip地址 101.132.139.80）</span></span><br><span class="line">iflytek_yuyin:</span><br><span class="line">    api_id: <span class="string">'填写你的讯飞应用的Api ID'</span></span><br><span class="line">    api_key: <span class="string">'填写你的讯飞应用的Api Key'</span>  <span class="comment"># 没看到这个说明不是注册的WebAPI应用，请改注册个WebAPI应用</span></span><br><span class="line">    vid: <span class="string">'67100'</span> <span class="comment">#语音合成选项： 60120为小桃丸 67100为颖儿 60170为萌小新 更多音色见wiki</span></span><br><span class="line">    url: <span class="string">'http://api.musiiot.top/stt.php'</span> <span class="comment"># 白名单ip中转服务器（可选）</span></span><br><span class="line">    tts:</span><br><span class="line">        api_id: <span class="string">'***'</span> <span class="comment"># 这项不填可以使用上层配置</span></span><br><span class="line">        api_key: <span class="string">'**********************'</span></span><br><span class="line">        voice_name: xiaoyan</span><br><span class="line">        proxy: <span class="string">'http://123.207.49.217:8028'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 阿里云语音</span></span><br><span class="line"><span class="comment"># ak_id及ak_secret需前往</span></span><br><span class="line"><span class="comment"># https://data.aliyun.com/product/nls</span></span><br><span class="line"><span class="comment"># 注册获取</span></span><br><span class="line">ali_yuyin:</span><br><span class="line">    ak_id: <span class="string">'填写你的阿里云应用的AcessKey ID'</span></span><br><span class="line">    ak_secret: <span class="string">'填写你的阿里云应用的AcessKey Secret'</span></span><br><span class="line">    voice_name: <span class="string">'xiaoyun'</span> <span class="comment">#xiaoyun为女生，xiaogang为男生</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 谷歌语音</span></span><br><span class="line"><span class="comment"># api_key 的获取方式：</span></span><br><span class="line"><span class="comment"># 1. Join the Chromium Dev group:</span></span><br><span class="line"><span class="comment">#     https://groups.google.com/a/chromium.org/forum/?fromgroups#!forum/chromium-dev</span></span><br><span class="line"><span class="comment"># 2. Create a project through the Google Developers console:</span></span><br><span class="line"><span class="comment">#     https://console.developers.google.com/project</span></span><br><span class="line"><span class="comment"># 3. Select your project. In the sidebar, navigate to "APIs &amp; Auth." Activate</span></span><br><span class="line"><span class="comment">#     the Speech API.</span></span><br><span class="line"><span class="comment"># 4. Under "APIs &amp; Auth," navigate to "Credentials." Create a new key for</span></span><br><span class="line"><span class="comment">#     public API access.</span></span><br><span class="line">google_yuyin:</span><br><span class="line">    language: <span class="string">'zh-CN'</span></span><br><span class="line">    api_key: <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 聊天机器人</span></span><br><span class="line"><span class="comment"># 可选值：</span></span><br><span class="line"><span class="comment"># tuling    - 图灵机器人</span></span><br><span class="line"><span class="comment"># emotibot  - 小影机器人</span></span><br><span class="line">robot: tuling</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图灵机器人</span></span><br><span class="line"><span class="comment"># http://www.tuling123.com</span></span><br><span class="line">tuling:</span><br><span class="line">    tuling_key: <span class="string">'填写你的图灵机器人API Key'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 小影机器人</span></span><br><span class="line"><span class="comment"># http://botfactory.emotibot.com/</span></span><br><span class="line">emotibot:</span><br><span class="line">    appid: <span class="string">'填写你的 emotibot appid'</span></span><br><span class="line">    active_mode: <span class="literal">true</span>  <span class="comment"># 是否主动说更多点话</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 信号灯(可选)</span></span><br><span class="line"><span class="comment"># 将普通led接入树莓派GPIO， 唤醒后常亮，思考及说话时闪亮</span></span><br><span class="line">signal_led:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">false</span></span><br><span class="line">    gpio_mode: <span class="string">"bcm"</span> <span class="comment"># "bcm" 或 "board"</span></span><br><span class="line">    pin: 24 <span class="comment"># led 正极接脚， 负极接GND</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 邮箱</span></span><br><span class="line"><span class="comment"># 如果使用网易邮箱，还需设置允许第三方客户端收发邮件</span></span><br><span class="line">email:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">    address: <span class="string">'你的邮箱地址'</span></span><br><span class="line">    password: <span class="string">'你的邮箱密码'</span>  <span class="comment"># 如果是网易邮箱，须填写应用授权密码而不是登录密码！</span></span><br><span class="line">    smtp_server: <span class="string">'smtp.163.com'</span></span><br><span class="line">    smtp_port: <span class="string">'25'</span>  <span class="comment"># 这里填写非SSL协议端口号</span></span><br><span class="line">    imap_server: <span class="string">'imap.163.com'</span></span><br><span class="line">    imap_port: <span class="string">'143'</span>  <span class="comment"># 这里填写非SSL协议端口号</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拍照</span></span><br><span class="line"><span class="comment"># 需接入摄像头才能使用</span></span><br><span class="line">camera:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">false</span></span><br><span class="line">    dest_path: <span class="string">"/home/pi/camera"</span> <span class="comment"># 保存目录</span></span><br><span class="line">    quality: 5            <span class="comment"># 成像质量（0~100）</span></span><br><span class="line">    vertical_flip: <span class="literal">true</span>     <span class="comment"># 竖直翻转</span></span><br><span class="line">    horizontal_flip: <span class="literal">false</span>  <span class="comment"># 水平翻转</span></span><br><span class="line">    count_down: 3           <span class="comment"># 倒计时（秒），仅当开启倒计时时有效</span></span><br><span class="line">    sendToUser: <span class="literal">true</span>        <span class="comment"># 拍完照是否发送到邮箱/微信    </span></span><br><span class="line">    sound: <span class="literal">true</span>             <span class="comment"># 是否有拍照音效</span></span><br><span class="line">    usb_camera: <span class="literal">false</span>       <span class="comment"># 是否使用USB摄像头（默认是树莓派5MP摄像头）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"><span class="comment"># 第三方插件的配置</span></span><br><span class="line"><span class="comment">#######################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在这里放第三方插件的配置</span></span><br><span class="line"><span class="comment"># https://github.com/wzpan/dingdang-contrib</span></span><br></pre></td></tr></table></figure>

<h4 id="修改唤醒词"><a href="#修改唤醒词" class="headerlink" title="修改唤醒词"></a>修改唤醒词</h4><p>如果使用的是 PocketSphinx</p>
<p>在 profile.yml 配置文件中修改 robot_name 和 robot_name_cn 配置项；<br>编写一个 keyword.txt 文件，包含至少两个名字的全拼：<br>DINGDANG<br>ROBOT<br>其中 ROBOT 替换为你需要的机器人名字的全拼。</p>
<p>到 <a href="http://www.speech.cs.cmu.edu/tools/lmtool-new.html" target="_blank" rel="noopener">lmtool</a> 里上传你刚刚创建的 keyword.txt 并编译成模型。<br>把得到的 .dic 文件和 .lm 文件分别重命名为 dictionary 和 languagemodel，替换 /home/pi/.dingdang/vocabularies/pocketsphinx-vocabulary/keyword 下的同名文件。<br>重新运行 dingdang ，看看新的唤醒词灵敏度如何。如果不理想，换成别的唤醒词.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Raspberry/" rel="tag"># Raspberry</a>
              <a href="/tags/sailbox/" rel="tag"># sailbox</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
                <a href="/posts/project/ideaTalk/0_base_raspberry.html" rel="next" title="树莓派的折腾笔记">
                  <i class="fa fa-chevron-left"></i> 树莓派的折腾笔记
                </a>
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
                <a href="/posts/project/ideaTalk/2_server_rpi.html" rel="prev" title="Server In RPi">
                  Server In RPi <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Inhaltsverzeichnis
        </li>
        <li class="sidebar-nav-overview">
          Übersicht
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-名称由来"><span class="nav-number">1.</span> <span class="nav-text">0x01 名称由来</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-基本的配置过程"><span class="nav-number">2.</span> <span class="nav-text">0x02 基本的配置过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-安装Jasper"><span class="nav-number">3.</span> <span class="nav-text">0x03 安装Jasper</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-安装STT（语音识别）引擎和TTS（文本转文本）引擎"><span class="nav-number">4.</span> <span class="nav-text">0x04 安装STT（语音识别）引擎和TTS（文本转文本）引擎</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-STT-引擎（Choosing-an-STT-engine）"><span class="nav-number">4.1.</span> <span class="nav-text">安装 STT 引擎（Choosing an STT engine）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PocketSphinx-STT-engine"><span class="nav-number">4.1.1.</span> <span class="nav-text">PocketSphinx STT engine</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Julius-STT-engine"><span class="nav-number">4.1.2.</span> <span class="nav-text">Julius STT engine</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-TTS-引擎（Choosing-a-TTS-engine）"><span class="nav-number">4.2.</span> <span class="nav-text">安装 TTS 引擎（Choosing a TTS engine）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-安装百度语音引擎"><span class="nav-number">5.</span> <span class="nav-text">0x05 安装百度语音引擎</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-配置文件（-jasper-profile-yml）"><span class="nav-number">6.</span> <span class="nav-text">0x06 配置文件（.jasper/profile.yml）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#生成配置文件"><span class="nav-number">6.1.</span> <span class="nav-text">生成配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置Spotify"><span class="nav-number">6.2.</span> <span class="nav-text">配置Spotify</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-如何使用"><span class="nav-number">7.</span> <span class="nav-text">0x07 如何使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x08-其他"><span class="nav-number">8.</span> <span class="nav-text">0x08 其他</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x09-profile的书写"><span class="nav-number">9.</span> <span class="nav-text">0x09 profile的书写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#修改唤醒词"><span class="nav-number">9.0.1.</span> <span class="nav-text">修改唤醒词</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="Pursuer"
    src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Pursuer</p>
  <div class="site-description" itemprop="description">追根溯源，返璞归真</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">Artikel</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">Kategorien</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">schlagwörter</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pursuer</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Alle Besucher">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Alle Aufrufe">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  


















  

  

  

  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>
</body>
</html>
